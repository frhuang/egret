var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},s.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this._touchStatus=!1,this._distance=new egret.Point,this._x=[],this._y=[],this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){Const.SWIDTH=this.stage.stageWidth,Const.SHEIGHT=this.stage.stageHeight,this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},s.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},s.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},s.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},s.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},s.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},s.createGameScene=function(){var t=new MainGame;this.addChild(t)},s.touchStart=function(t){this._touchStatus=!0;var e=t.stageX,i=t.stageY;this._shape.graphics.moveTo(e,i),this._shape.graphics.lineTo(e+1,i)},s.touchMove=function(t){if(this._touchStatus){var e=t.stageX,i=t.stageY;this.movePoint(e,i)}},s.touchEnd=function(t){this._touchStatus=!1,this._x=[],this._y=[]},s.movePoint=function(t,e){this._x.push(t),this._y.push(e);var i=this._shape;i.graphics.lineTo(t,e)},s.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var GameStart=function(t){function e(){t.call(this),this.init()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.init=function(){var t=ResourceUtils.createBitmapByName("page1_5_png");this.addChild(t),t.x=Const.SWIDTH/2-t.width/2,t.y=0;var e=new MyButton("btn1_png","btn1_png");this.addChild(e),e.x=Const.SWIDTH/2-e.width/2,e.y=Const.SHEIGHT-300,e.setClick(this.showPage2View.bind(this))},s.showPage2View=function(){this.parent&&this.parent.removeChild(this),MainGame.game.start()},e}(egret.Sprite);egret.registerClass(GameStart,"GameStart");var MainGame=function(t){function e(){t.call(this),e.game=this,this.init()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.init=function(){this.gameContainer=new egret.Sprite,this.addChild(this.gameContainer),this.showStart()},s.start=function(){this.clear(),showPage("p1-1"),this._pageScene1=new PageScene1,this.gameContainer.addChild(this._pageScene1)},s.nextScene=function(){this.clear();var t=new PageScene2;this.gameContainer.addChild(t)},s.clear=function(){for(;this.gameContainer.numChildren;)this.gameContainer.removeChildAt(0)},s.showStart=function(){this.clear(),this._startScene=new GameStart,this.gameContainer.addChild(this._startScene)},e}(egret.Sprite);egret.registerClass(MainGame,"MainGame");var PageScene1=function(t){function e(){t.call(this),this._touchStatus=!1,this._distance=new egret.Point,this._x=[],this._y=[],this._all_X_Y=[],this._all_Y_X=[],this.init()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.init=function(){var t=ResourceUtils.createBitmapByName("p1-area_png");this.addChild(t),t.x=Const.SWIDTH/2-t.width/2,t.y=Const.SHEIGHT/2-t.height/2,t.touchEnabled=!0;var e=new MyButton("btn2_png","btn2_png");this.addChild(e),e.x=Const.SWIDTH/2-150,e.y=Const.SHEIGHT-120,e.setClick(this.confirmClick.bind(this));var i=new MyButton("btn3_png","btn3_png");this.addChild(i),i.x=Const.SWIDTH/2+100,i.y=Const.SHEIGHT-120,i.setClick(this.redrawClick.bind(this)),this._shape=new egret.Shape,this.addChild(this._shape),this._shape.graphics.lineStyle(2,0),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchStart,this),t.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this)},s.confirmClick=function(){this._all_X_Y.length>0&&(Const.ALL_X_Y=this._all_X_Y,Const.ALL_Y_X=this._all_Y_X,egret.setTimeout(function(){MainGame.game.nextScene()},this,200))},s.redrawClick=function(){this._shape.graphics.clear(),this._all_X_Y=[],this._all_Y_X=[],this._shape.graphics.lineStyle(2,0)},s.touchStart=function(t){this._touchStatus=!0;var e=t.stageX,i=t.stageY;this._shape.graphics.moveTo(e,i),this._shape.graphics.lineTo(e+1,i)},s.touchMove=function(t){if(this._touchStatus){var e=t.stageX,i=t.stageY;this.movePoint(e,i)}},s.touchEnd=function(t){this._all_X_Y.push(this._x),this._all_Y_X.push(this._y),this._touchStatus=!1,this._x=[],this._y=[]},s.movePoint=function(t,e){this._x.push(t),this._y.push(e);var i=this._shape;i.graphics.lineTo(t,e)},e}(egret.Sprite);egret.registerClass(PageScene1,"PageScene1");var PageScene2=function(t){function e(){t.call(this),this._touchStatus1=!1,this._touchStatus2=!1,this._touchStatus3=!1,this._distance=new egret.Point,this._index=0,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){this.init()},s.init=function(){this._index=0,this._car=new egret.Sprite,this.addChild(this._car);var t=new MyButton("btn2_png","btn2_png");this.addChild(t),t.x=Const.SWIDTH/2-150,t.y=Const.SHEIGHT-120,t.setClick(this.confirmClick.bind(this)),this._confirm_btn=t;var e=new MyButton("btn3_png","btn3_png");this.addChild(e),e.x=Const.SWIDTH/2+100,e.y=Const.SHEIGHT-120,e.setClick(this.redrawClick.bind(this)),this._redraw_btn=e,this.initShape(),this.initShoe()},s.initShape=function(){this._shape=new egret.Shape,this._car.addChild(this._shape),this._shape.graphics.lineStyle(2,0);for(var t=Const.ALL_X_Y.length,e=0;t>e;e++){var i=[],s=[];i=Const.ALL_X_Y[e],s=Const.ALL_Y_X[e],this._shape.graphics.moveTo[(i[0]+1,s[0])];for(var n=i.length,h=0;n>h;h++)this._shape.graphics.lineTo(i[h],s[h])}},s.initShoe=function(){var t=ResourceUtils.createBitmapByName("shoe_png");this._car.addChild(t),t.x=Const.SWIDTH/2-t.width/2-100,t.y=Const.SHEIGHT/2-t.height/2,t.anchorOffsetX=.5,t.anchorOffsetY=.5,this._leftShoe=t,this._rightShoe=ResourceUtils.createBitmapByName("shoe_png"),this._car.addChild(this._rightShoe),this._rightShoe.x=Const.SWIDTH/2-this._rightShoe.width/2+100,this._rightShoe.y=Const.SHEIGHT/2-this._rightShoe.height/2,this._leftShoe.touchEnabled=!0,this._rightShoe.touchEnabled=!0,this._leftShoe.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.leftShoeDown,this),this._leftShoe.addEventListener(egret.TouchEvent.TOUCH_END,this.leftShoeUp,this),this._rightShoe.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.rightShoeDown,this),this._rightShoe.addEventListener(egret.TouchEvent.TOUCH_END,this.rightShoeUp,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchStart,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this)},s.leftShoeDown=function(t){this._touchStatus1=!0,this._distance.x=t.stageX-this._leftShoe.x,this._distance.y=t.stageY-this._leftShoe.y},s.leftShoeUp=function(t){this._touchStatus1=!1},s.rightShoeDown=function(t){this._touchStatus2=!0,this._distance.x=t.stageX-this._rightShoe.x,this._distance.y=t.stageY-this._rightShoe.y},s.rightShoeUp=function(t){this._touchStatus2=!1},s.touchStart=function(t){var e=t.stageX,i=t.stageY;1===this._index&&(this._touchStatus3=!0,this._lineShape.graphics.moveTo(e,i),this._lineShape.graphics.lineTo(e+1,i))},s.touchMove=function(t){if(0===this._index){if(this._touchStatus1){var e=t.stageX-this._distance.x,i=t.stageY-this._distance.y;100>e?e=100:e>200&&(e=200),i<Const.SHEIGHT/2?i=Const.SHEIGHT/2:i>Const.SHEIGHT/2+200&&(i=Const.SHEIGHT/2+200),this._leftShoe.x=e,this._leftShoe.y=i}this._touchStatus2&&(this._rightShoe.x=t.stageX-this._distance.x,this._rightShoe.y=t.stageY-this._distance.y)}else if(1===this._index&&this._touchStatus3){var e=t.stageX,i=t.stageY;this.movePoint(e,i)}},s.touchEnd=function(t){},s.confirmClick=function(){0===this._index?this.page2End():1===this._index&&this.page3End()},s.redrawClick=function(){1===this._index&&this._lineShape.graphics.clear()},s.page2End=function(){this.btnHide(),this._leftShoe.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.leftShoeDown,this),this._leftShoe.removeEventListener(egret.TouchEvent.TOUCH_END,this.leftShoeUp,this),this._rightShoe.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.rightShoeDown,this),this._rightShoe.removeEventListener(egret.TouchEvent.TOUCH_END,this.rightShoeUp,this),this._touchStatus1=!1,this._touchStatus2=!1,this.carMove()},s.page3End=function(){this.btnHide(),egret.Tween.get(this._car).to({x:Const.SWIDTH,y:Const.SHEIGHT-300},2e3).call(this.moveToNext,this)},s.btnShow=function(){this._confirm_btn.visible=!0,this._redraw_btn.visible=!0},s.btnHide=function(){this._confirm_btn.visible=!1,this._redraw_btn.visible=!1},s.carMove=function(){this.shoeMove(),egret.Tween.get(this._shape).wait(2e3).call(this.page3Start,this)},s.shoeMove=function(){egret.Tween.get(this._leftShoe,{loop:!0}).to({rotation:360},2e3),egret.Tween.get(this._rightShoe,{loop:!0}).to({rotation:360},2e3)},s.page3Start=function(){egret.Tween.pauseTweens(this._shape),egret.Tween.get(this._car).to({scale:.6,x:-100,y:0},1e3).wait(500).call(this.showSprites,this)},s.showSprites=function(){var t=ResourceUtils.createBitmapByName("sprites_jpg");this.addChild(t),t.x=Const.SWIDTH+t.width,t.y=Const.SHEIGHT/2-t.height/2,this._sprites=t,egret.Tween.get(t).to({x:Const.SWIDTH-t.width},2e3).call(this.showDrawLine,this)},s.showDrawLine=function(){this._index=1,this.btnShow(),this._lineShape=new egret.Shape,this.stage.addChild(this._lineShape),this._lineShape.graphics.lineStyle(2,0)},s.movePoint=function(t,e){var i=this._lineShape;i.graphics.lineTo(t,e)},s.moveToNext=function(){this._car.x=-Const.SWIDTH,this._lineShape.graphics.clear(),this.removeChild(this._sprites),egret.Tween.get(this._car).wait(200).to({x:0,y:this._car.y},2e3).call(this.page4Start,this)},s.page4Start=function(){this._index=2},e}(egret.DisplayObjectContainer);egret.registerClass(PageScene2,"PageScene2");var Const=function(){function t(){}var e=(__define,t);e.prototype;return t.ALL_X_Y=[],t.ALL_Y_X=[],t}();egret.registerClass(Const,"Const");var MyButton=function(t){function e(e,i){t.call(this),this.sp=new egret.Sprite,this.addChild(this.sp),this.bg=ResourceUtils.createBitmapByName(e),this.sp.addChild(this.bg),this.title=ResourceUtils.createBitmapByName(i),null==this.title.texture&&(this.title.texture=RES.getRes(i)),this.sp.addChild(this.title)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.setClick=function(t){this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickEvent,this),this.onClick=t},s.onClickEvent=function(){(this.sp.width-.8*this.sp.width)/2,(this.sp.height-.8*this.sp.height)/2;this.tw=egret.Tween.get(this.sp),this.tw.call(this.onClickHandler,this)},s.onClickHandler=function(){this.onClick()},e}(egret.Sprite);egret.registerClass(MyButton,"MyButton");var ResourceUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t.createBitmapFromSheet=function(t,e){void 0===e&&(e="gameRes");var i=RES.getRes(e),s=i.getTexture(t),n=new egret.Bitmap;return n.texture=s,n},t.getTextureFromSheet=function(t,e){void 0===e&&(e="gameRes");var i=RES.getRes(e),s=i.getTexture(t);return s},t}();egret.registerClass(ResourceUtils,"ResourceUtils");